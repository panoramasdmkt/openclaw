version: "3.8"

services:
  gateway:
    build: .
    restart: unless-stopped
    
    networks:
      - dokploy-network
    
    environment:
      - HOME=/home/node
      - NODE_ENV=production
      - OPENCLAW_GATEWAY_BIND=0.0.0.0
      - OPENCLAW_GATEWAY_PORT=18789
      - OPENCLAW_GATEWAY_TOKEN=${OPENCLAW_GATEWAY_TOKEN}
      - GOG_KEYRING_PASSWORD=${GOG_KEYRING_PASSWORD}
      - INSTAGRAM_TOKEN=${INSTAGRAM_TOKEN}
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - XDG_CONFIG_HOME=/home/node/.openclaw
    
    volumes:
      - /root/openclaw-data/config:/home/node/.openclaw
      - /root/openclaw-data/workspace:/home/node/.openclaw/workspace

    command: ["node", "openclaw.mjs", "gateway", "--bind", "lan", "--allow-unconfigured", "10.0.0.0/8,172.16.0.0/12,192.168.0.0/16"]
      

networks:
  dokploy-network:
    external: true
